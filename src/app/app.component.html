<ng-container *ngIf="(authorized$ | async); else authorizing">
  <mat-sidenav-container *ngIf="clients">
    <mat-sidenav mode="push" [opened]="sidebarOpen$ | async" (openend)="sidebarOpened()" (closed)="sidebarClosed()">
      <mat-toolbar class="mat-elevation-z4" color="primary">
        <mat-toolbar-row>
          <span>{{appName}}</span>
        </mat-toolbar-row>
      </mat-toolbar>
      <mat-nav-list>
        <a *ngFor="let item of menuItems" [routerLink]="item.path" routerLinkActive="selected" mat-list-item>
          <span>{{item.label}}</span>
          <!-- <mat-icon mat-list-icon *ngIf="item.icon" [svgIcon]="item.icon"></mat-icon> -->
        </a>
        <mat-divider></mat-divider>
        <ng-container *ngIf="clients?.length">
          <h3 mat-subheader>Clients</h3>
          <a *ngFor="let client of clients" [routerLink]="['client', client.id]" routerLinkActive="selected" mat-list-item>
            <mat-icon mat-list-icon *ngIf="client.icon" [svgIcon]="client.icon"></mat-icon>
            <span>{{client.label}}</span>
          </a>
        </ng-container>
        <mat-divider></mat-divider>
        <ng-container *ngIf="configs?.length">
          <h3 mat-subheader>Configs</h3>
          <a *ngFor="let item of configs" [routerLink]="['config', item.id]" routerLinkActive="selected" mat-list-item>
            <span>{{item.label}}</span>
          </a>
          <mat-divider></mat-divider>
        </ng-container>

        <a mat-list-item routerLink="/logout" (click)="logout()">
          <span>Logout</span>
          <!-- <mat-icon mat-list-icon svgIcon="user-solid-circle"></mat-icon> -->
        </a>
      </mat-nav-list>
    </mat-sidenav>
    <mat-sidenav-content>
      <router-outlet></router-outlet>
    </mat-sidenav-content>
  </mat-sidenav-container>
</ng-container>

<ng-template #authorizing>
  <mat-card *ngIf="(errorMessage$ | async) as error; else loading">
    <mat-card-content>
    <h2>Unable to authorize application</h2>
    <button mat-raised-button color="warn" routerLink="/">
      Go Home
    </button>
  </mat-card-content>
  </mat-card>
  <ng-template #loading>
    <mat-card>
      <mat-card-title class="center">Authorizing Application</mat-card-title>
      <mat-card-content fxLayout fxLayoutAlign="center">
        <ng-template #loading><mat-spinner></mat-spinner></ng-template>
      </mat-card-content>
    </mat-card>
  </ng-template>
</ng-template>
